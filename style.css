/* =========================================
   ШРИФТЫ
========================================= */
@font-face{font-family:"PT Sans";src:url("PT_Sans-Web-Regular.ttf") format("truetype");font-weight:400;font-style:normal;font-display:swap;}
@font-face{font-family:"PT Sans";src:url("PT_Sans-Web-Bold.ttf")    format("truetype");font-weight:700;font-style:normal;font-display:swap;}
@font-face{font-family:"PT Sans";src:url("PT_Sans-Web-Italic.ttf")  format("truetype");font-weight:400;font-style:italic;font-display:swap;}
@font-face{font-family:"PT Sans";src:url("PT_Sans-Web-BoldItalic.ttf") format("truetype");font-weight:700;font-style:italic;font-display:swap;}

/* =========================================
   ТЕМЫ (переменные)
   — Светлая по умолчанию
   — Тёмная по data-theme="dark"
========================================= */
:root{
  /* Бренд и базовые цвета */
  --blue: #004F9F;
  --bg: #ffffff;
  --text: #111111;
  --muted: #eaf2ff;

  /* Поверхности/границы/подсказки */
  --surface: #f7f9ff;
  --panel: #cccccc;    /* фон панели чата */
  --panel-2: #f5f5f5;  /* фон пузыря бота */
  --border: #e5e5e5;

  --tooltip-bg: #333333;
  --tooltip-fg: #ffffff;

  /* Радиусы/отступы/размеры */
  --radius: 25px;
  --gap-x: 28px;
  --btn-gap: 26px;
  --btn-w: 306px;
  --btn-h: 180px;

  --container-w: 1200px;
  --stage-right-w: 360px;
  --header-h: 70px;
}

:root[data-theme="dark"]{
  --blue: #0b3a6a;
  --bg: #0f1115;
  --text: #eef2f8;
  --muted: #93a7c6;

  --surface: #131823;
  --panel: #1a1f2a;
  --panel-2: #232a36;
  --border: #2a3240;

  --tooltip-bg: #1f2530;
  --tooltip-fg: #eef2f8;
}

/* =========================================
   БАЗА / СЕТКА
========================================= */
*{margin:0;padding:0;box-sizing:border-box;}
html,body{
  font-family:"PT Sans",system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
  font-weight:700;
  color:var(--text);
  background:var(--bg);
}
.wrapper{min-height:100vh;display:flex;flex-direction:column;}
main{flex:1;}               /* footer всегда внизу */
.container{
  width:100%;
  max-width: calc(4 * var(--btn-w) + 3 * var(--btn-gap) + 2 * var(--gap-x));
  margin:0 auto;
  padding:0 var(--gap-x);
}

/* =========================================
   HEADER (во всю ширину, скругления снизу)
   — логотип слева, группа кнопок справа
========================================= */
header{
  background: var(--blue);
  color: var(--muted);
  border-radius: 0 0 var(--radius) var(--radius);
  height: var(--header-h);
  display:flex; align-items:center;
}

.header-bar{ background:transparent; height:100%; }
.header-bar-inner{
  height: 100%;
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 0 20px;
  width: 100%;
  max-width: var(--container-w);
  margin: 0 auto;
}

/* Группа кнопок прижимается вправо */
.header-actions{
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 14px;
}

.brand{ display:inline-flex; align-items:center; }
.brand img{ width:48px; height:48px; display:block; border-radius:12px; }

/* Кнопка Plus */
.title{
  background:transparent;
  color:#eaf2ff;
  border:0;
  font-size:clamp(20px,2vw,32px);
  font-weight:700;
  cursor:pointer;
  transition: color .2s ease, transform .18s ease;
}
.title:hover{ color:#ffd54a; transform: scale(1.08); }  /* увеличение на hover */

/* Кнопка темы */
.theme-btn{
  width:40px; height:40px; border-radius:50%; border:0; background:transparent;
  display:inline-flex; align-items:center; justify-content:center; cursor:pointer;
  transition: transform .18s ease, background-color .18s ease;
  overflow:hidden;
}
.theme-btn img{ width:24px; height:24px; display:block; }
.theme-btn:hover{ background: rgba(255,255,255,.12); transform: scale(1.08); }
:root[data-theme="dark"] .theme-btn:hover{ background: rgba(255,255,255,.08); }
.theme-btn:active{ transform: scale(.9); }

/* Профиль */
.profile{
  width:40px; height:40px; border-radius:50%; overflow:hidden;
  display:inline-flex; align-items:center; justify-content:center;
  background:transparent; border:0; cursor:pointer;
  transition: transform .18s ease, background-color .18s ease;
}
.profile img{ width:100%; height:100%; object-fit:cover; }
.profile:hover{ transform: scale(1.08); }

/* =========================================
   МЕНЮ ПРОФИЛЯ (классический список)
========================================= */
.profile-wrap{ position:relative; display:inline-flex; align-items:center; }
.profile-menu{
  position:absolute;
  top: calc(100% + 8px); right:0;
  background: var(--surface);
  border:1px solid var(--border);
  border-radius:12px;
  box-shadow:0 12px 28px rgba(0,0,0,.2);
  opacity:0; transform:translateY(-6px);
  pointer-events:none; transition: opacity .2s ease, transform .2s ease;
  z-index:1000; min-width:220px;
}
.profile-menu.active{ opacity:1; transform:translateY(0); pointer-events:auto; }
.profile-list{ list-style:none; margin:0; padding:8px 0; }
.profile-list li+li{ border-top:1px solid var(--border); }
.profile-list a,.theme-toggle{
  display:block; width:100%;
  padding:10px 16px;
  text-decoration:none; color:var(--text);
  font-weight:600; font-size:.95rem;
  background:none; border:0; text-align:left; cursor:pointer;
}
.profile-list a:hover,.profile-list a:focus,.theme-toggle:hover{
  background: rgba(255,255,255,.06);
}

/* =========================================
   ВСТУПИТЕЛЬНЫЙ БЛОК
========================================= */
.intro{ margin:32px 0 16px; text-align:center; }
.intro p{
  max-width:720px; margin:0 auto;
  font-size:clamp(1rem,1.2vw,1.25rem);
  font-weight:400; line-height:1.5; color:var(--text);
}
.intro strong{ color:var(--blue); }


/* === Header: кнопка "Войти" (контрастная, с анимациями) === */
.header-actions .login-btn{
  display:inline-flex; align-items:center; gap:8px;
  padding:8px 16px;
  border:1px solid var(--blue, #2563eb);
  border-radius:999px;
  background: var(--blue, #2563eb);
  color:#fff;
  text-decoration:none;
  font-weight:600;
  line-height:1;
  transition: transform .2s ease, box-shadow .25s ease, background-color .25s ease, color .25s ease;
  will-change: transform, box-shadow;
  box-shadow: 0 2px 8px rgba(37,99,235,.25);
}

/* hover/focus — немного ярче и с лёгким свечением */
.header-actions .login-btn:hover,
.header-actions .login-btn:focus-visible{
  background: color-mix(in oklab, var(--blue, #2563eb), white 10%);
  border-color: color-mix(in oklab, var(--blue, #2563eb), white 10%);
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(37,99,235,.35);
  outline: none;
}

/* active/press — эффект нажатия */
.header-actions .login-btn.is-pressing{
  transform: scale(0.97) !important;
  box-shadow: 0 2px 8px rgba(0,0,0,.15) !important;
}

/* иконка */
.header-actions .login-btn svg{
  flex:0 0 auto;
  stroke:#fff;
  transition: stroke .25s ease;
}

/* светлая тема — чуть темнее фон, чтобы текст и иконка не терялись */
:root[data-theme="light"] .header-actions .login-btn{
  background: color-mix(in oklab, var(--blue, #2563eb), black 5%);
  border-color: var(--blue, #2563eb);
  color:#fff;
}
:root[data-theme="light"] .header-actions .login-btn:hover,
:root[data-theme="light"] .header-actions .login-btn:focus-visible{
  background: color-mix(in oklab, var(--blue, #2563eb), white 5%);
  border-color: color-mix(in oklab, var(--blue, #2563eb), white 5%);
}

/* тёмная тема — чуть ярче фон для читаемости */
:root[data-theme="dark"] .header-actions .login-btn{
  background: color-mix(in oklab, var(--blue, #60a5fa), black 10%);
  border-color: color-mix(in oklab, var(--blue, #60a5fa), black 5%);
  color:#fff;
}
:root[data-theme="dark"] .header-actions .login-btn:hover,
:root[data-theme="dark"] .header-actions .login-btn:focus-visible{
  background: color-mix(in oklab, var(--blue, #60a5fa), white 10%);
  border-color: color-mix(in oklab, var(--blue, #60a5fa), white 10%);
}

/* фокус-ринги для доступности */
.header-actions .login-btn:focus-visible{
  box-shadow:
    0 0 0 3px color-mix(in oklab, var(--blue, #2563eb), white 65%),
    0 6px 16px rgba(37,99,235,.25);
}

/* отключённая кнопка */
.header-actions .login-btn[aria-disabled="true"]{
  opacity:.6; pointer-events:none;
}

@media (prefers-reduced-motion: reduce){
  .header-actions .login-btn{ transition:none; }
}

/* =========================================
   4 КНОПКИ (акции)
========================================= */
.actions{
  margin-top:22px;
  display:grid;
  grid-template-columns: repeat(2, var(--btn-w));
  column-gap: var(--btn-gap);
  row-gap: var(--btn-gap);
  justify-content:center;

  position:relative; z-index:0; isolation:isolate;
}
.action-card{
  width:var(--btn-w); height:var(--btn-h);
  border-radius:var(--radius);
  background:var(--blue); color:#eaf2ff;
  display:flex; align-items:center; justify-content:center;
  position:relative; z-index:1;
  cursor:pointer; border:0;
  transition: transform .2s ease, filter .2s ease;
}
.action-card:hover{ transform:translateY(-5px); filter:brightness(1.06); }
.action-card:hover,.action-card:focus-within{ z-index:999; }
.action-title{ font-size:clamp(18px,1.4vw,22px); }

/* Тултип на иконке вопроса */
.info-icon{
  position:absolute; right:14px; top:14px;
  width:22px; height:22px;
  background-image:url("question.svg");
  background-repeat:no-repeat; background-position:center; background-size:contain;
  z-index:2;
}
.info-icon::after{
  content:attr(data-info);
  position:absolute; top:50%; left:calc(100% + 10px);
  transform:translateY(-50%) translateX(8px);
  background: var(--tooltip-bg); color: var(--tooltip-fg);
  padding:8px 10px; border-radius:10px; max-width:240px;
  font-weight:400; font-size:14px; line-height:1.35;
  opacity:0; pointer-events:none; transition:.25s;
  box-shadow:0 10px 20px rgba(0,0,0,.18);
  z-index:3;
}
.info-icon::before{
  content:""; position:absolute; top:50%; left:calc(100% + 4px);
  width:10px; height:10px;
  transform:translateY(-50%) rotate(45deg);
  background: var(--tooltip-bg);
  opacity:0; transition:.25s; z-index:3;
}
/* hover-подсказка */
.info-icon:hover::after{ opacity:1; transform:translateY(-50%) translateX(0); }
.info-icon:hover::before{ opacity:1; transform:translateY(-50%) rotate(45deg) translateX(0); }
/* click/тач-подсказка */
.info-icon.active::after,
.info-icon.active::before{ opacity:1; transform:translateY(-50%) translateX(0) rotate(45deg); }
/* Для правого столбца — пузырь влево */
.actions .action-card:nth-child(2n) .info-icon::after{
  left:auto; right:calc(100% + 10px);
  transform:translateY(-50%) translateX(-8px);
}
.actions .action-card:nth-child(2n) .info-icon::before{
  left:auto; right:calc(100% + 4px);
  transform:translateY(-50%) rotate(45deg) translateX(-8px);
}
.actions .action-card:nth-child(2n) .info-icon:hover::after{
  transform:translateY(-50%) translateX(0);
}
.actions .action-card:nth-child(2n) .info-icon:hover::before{
  transform:translateY(-50%) rotate(45deg) translateX(0);
}
/* click/тач активное состояние для правых карточек */
.actions .action-card:nth-child(2n) .info-icon.active::after{
  left:auto; right:calc(100% + 10px); transform:translateY(-50%) translateX(0);
}
.actions .action-card:nth-child(2n) .info-icon.active::before{
  left:auto; right:calc(100% + 4px); transform:translateY(-50%) rotate(45deg) translateX(0);
}

/* =========================================
   СЦЕНА: слева чат, справа тян
========================================= */
.stage{
  margin-top:26px;
  display:grid;
  grid-template-columns: 1fr var(--stage-right-w);
  gap:28px;
  align-items:start;
}

/* Чат-панель = квадрат тян */
.chat-panel{
  background: var(--panel);
  border-radius: var(--radius);
  display:flex; flex-direction:column;
  height: var(--stage-right-w);
  min-height:0; overflow:hidden;
}
.chat-header{
  background: rgba(255,255,255,.06);
  display:flex; justify-content:space-between; align-items:center;
  padding:14px 16px; font-weight:700; border-bottom:1px solid var(--border);
}
.chat-actions{ display:flex; gap:10px; }
.chat-clear{ background:none;border:0;font-size:20px;color:#666;cursor:pointer; }
.chat-clear:hover{ color:#222; }

.chat-messages{
  flex:1; min-height:0; overflow:auto;
  padding:14px; display:flex; flex-direction:column; gap:8px;
  scrollbar-gutter:stable; overscroll-behavior:contain;
}
.msg{ padding:8px 12px; border-radius:12px; max-width:80%; line-height:1.4; word-break:break-word; font-weight:400; }
.msg.bot{ background: var(--panel-2); color: var(--text); align-self:flex-start; }
.msg.user{ background: var(--blue); color:#fff; align-self:flex-end; }
.empty{ text-align:center; color:#666; padding:24px 12px; font-weight:400; }

.chat-input{
  display:flex; gap:10px; padding:12px;
  background: rgba(255,255,255,.06);
  border-top:1px solid var(--border);
}
.chat-input input{
  flex:1; padding:10px 12px; border:1px solid var(--border); border-radius:10px;
  font-weight:400; background: var(--bg); color: var(--text);
}
.chat-input input:focus{ outline:none; border-color:#7fb3ff; }
.chat-input button{
  background:var(--blue); color:#fff; border:0; padding:10px 12px; border-radius:10px; cursor:pointer;
}
.chat-input button:hover{ filter:brightness(1.08); }

/* Правая колонка — квадрат с аниме-тян */
.avatar-box{
  width:var(--stage-right-w); height:var(--stage-right-w);
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:0; display:flex; align-items:center; justify-content:center;
}
.anime-rect{
  position:relative; width:100%; height:100%;
  border-radius:calc(var(--radius) - 6px);
  overflow:hidden; background:var(--surface);
}
.anime-rect .layer{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; pointer-events:none; opacity:0; }
.anime-rect .base{ opacity:1; }
.anime-rect .eyes.open{ opacity:1; }
.anime-rect .mouth.closed{ opacity:1; }
.anime-rect.is-typing .mouth.closed{ opacity:0; }
.anime-rect.is-typing .mouth.open{ opacity:1; }

/* =========================================
   МОДАЛКА ТАРИФОВ
========================================= */
.modal{ position:fixed; inset:0; background:rgba(0,0,0,.6);
  display:flex; justify-content:center; align-items:center;
  opacity:0; pointer-events:none; transition:opacity .25s ease; z-index:10000; }
.modal.active{ opacity:1; pointer-events:auto; }
body.modal-open{ overflow:hidden; }
.modal-content{
  background:var(--surface); color:var(--text);
  border-radius:var(--radius);
  padding:26px 24px;
  max-width:760px; width:90%; position:relative;
  animation:slideDown .25s ease;
  max-height:min(85vh,720px); overflow:auto;
  border:1px solid var(--border);
}
.modal-close{ position:absolute; top:12px; right:14px; font-size:28px; cursor:pointer; color:var(--text); background:none; border:0; }
@keyframes slideDown{ from{transform:translateY(-16px);opacity:0;} to{transform:translateY(0);opacity:1;} }
.modal h2{ text-align:center; margin:4px 0 16px; font-size:clamp(22px,2vw,28px); }

.plus-benefits{
  list-style:none; display:grid; grid-template-columns:1fr 1fr; gap:10px 16px; margin:0 0 18px; padding:0;
}
.plus-benefits li{
  background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:10px 12px; font-weight:400;
}

.tariff-cards{ display:grid; grid-template-columns:repeat(3,1fr); gap:16px; margin:6px 0 14px; }
.tariff-card{
  background:var(--surface); border:2px solid transparent; border-radius:16px; padding:16px; cursor:pointer; transition:.2s;
  display:flex; flex-direction:column; align-items:center; text-align:center;
}
.tariff-card:hover{ transform:translateY(-3px); box-shadow:0 8px 20px rgba(0,0,0,.12); }
.tariff-card.selected{ border-color:#4c9bff; background:rgba(76,155,255,.08); }
.tariff-card.popular::after{ content:"рекомендуем"; margin-top:8px; font-size:12px; color:#0b5bd3; background:#e7f0ff; padding:3px 8px; border-radius:999px; }
.price{ font-size:22px; font-weight:700; margin:0 0 6px; }
.sub{ font-size:13px; color:#666; }

.tariff-cta{ display:flex; justify-content:center; margin-top:4px; }
.pay-btn{ background:var(--blue); color:#fff; border:none; padding:12px 18px; border-radius:12px; cursor:pointer; min-width:180px; font-size:16px; }
.pay-btn:disabled{ opacity:.5; cursor:not-allowed; }
.pay-btn:not(:disabled):hover{ filter:brightness(1.08); }

/* =========================================
   ДОСТУПНОСТЬ: фокус */
.title:focus-visible,
.theme-btn:focus-visible,
.profile:focus-visible,
.action-card:focus-visible,
.tariff-card:focus-visible,
.pay-btn:focus-visible,
.chat-input input:focus-visible,
.chat-input button:focus-visible{
  outline: 2px solid #7fb3ff;
  outline-offset: 2px;
}

/* =========================================
   FOOTER
========================================= */
footer{
  background:var(--blue);
  color:var(--muted);
  text-align:center;
  padding:18px;
  border-top-left-radius:var(--radius);
  border-top-right-radius:var(--radius);
  margin-top:auto;
}

/* =========================================
   RIPPLE + КЛИК-ОТДАЧА
========================================= */
.click-anim{
  transform: scale(0.9);
  transition: transform .15s cubic-bezier(.34,1.56,.64,1),
              background-color .15s ease, color .15s ease;
}
.title.click-anim{ color: gold !important; }
.profile.click-anim{ background-color: rgba(0,0,0,0.08); }

.title,.profile{ position:relative; overflow:hidden; contain:paint; }
.ripple{
  position:absolute; left:0; top:0; width:0; height:0; border-radius:50%; pointer-events:none;
  transform:translate(-50%,-50%) scale(0);
  opacity:.35; animation:ripple-burst .85s ease-out forwards; z-index:0;
}
.ripple.golden{
  background: radial-gradient(circle,
    rgba(255,215,0,.65) 0%,
    rgba(255,215,0,.35) 60%,
    rgba(255,215,0,0) 70%);
}
.ripple.gray{
  background: radial-gradient(circle,
    rgba(0,0,0,.25) 0%,
    rgba(0,0,0,.18) 60%,
    rgba(0,0,0,0) 70%);
}
@keyframes ripple-burst{
  to{ transform:translate(-50%,-50%) scale(1); opacity:0; }
}
@media (prefers-reduced-motion: reduce){
  .ripple{ display:none !important; }
}

/* =========================================
   АДАПТИВ
========================================= */
@media (max-width:1320px){
  .actions{ grid-template-columns:repeat(2,var(--btn-w)); row-gap:var(--btn-gap); justify-content:center; }
}
@media (min-width:1360px){
  .actions{ grid-template-columns:repeat(4,var(--btn-w)); justify-content:space-between; }
}
@media (max-width:700px){
  .actions{ grid-template-columns:1fr; }
  .action-card{ width:100%; }
  .stage{ grid-template-columns:1fr; }
  .chat-panel{ height:auto; max-height:60vh; }

  /* откат тултипов: при одной колонке снова вправо */
  .actions .action-card:nth-child(2n) .info-icon::after{
    right:auto; left:calc(100% + 10px);
    transform: translateY(-50%) translateX(8px);
  }
  .actions .action-card:nth-child(2n) .info-icon::before{
    right:auto; left:calc(100% + 4px);
    transform: translateY(-50%) rotate(45deg) translateX(8px);
  }
  .actions .action-card:nth-child(2n) .info-icon:hover::after{
    transform: translateY(-50%) translateX(0);
  }
  .actions .action-card:nth-child(2n) .info-icon:hover::before{
    transform: translateY(-50%) rotate(45deg) translateX(0);
  }
  .actions .action-card:nth-child(2n) .info-icon.active::after{
    right:auto; left:calc(100% + 10px);
  }
  .actions .action-card:nth-child(2n) .info-icon.active::before{
    right:auto; left:calc(100% + 4px);
  }
}

/* ===== profile page ===== */
.page{ padding: 18px 0 24px; }
.breadcrumbs{
  font-weight:400; color:#666; margin:6px 0 10px;
  display:flex; gap:8px; align-items:center; flex-wrap:wrap;
}
.breadcrumbs a{ color:var(--blue); text-decoration:none; }
.page-title{ font-size:clamp(22px,2.2vw,28px); margin:8px 0 16px; }

.profile-grid{
  display:grid;
  grid-template-columns: 2fr 1fr;
  gap: 22px;
  align-items:start;
}
.card{
  background: var(--surface);
  border:1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
}
.card + .card{ margin-top: 16px; }
.card-title{ font-size:1.1rem; margin-bottom:12px; }

.identity .field{ display:flex; flex-direction:column; gap:6px; margin-bottom:10px; }
.identity .field > span{ font-weight:600; font-size:.95rem; }
.identity input, .identity select{
  padding:10px 12px; border:1px solid var(--border); border-radius:10px;
  background: var(--bg); color: var(--text); font-weight:400;
}
.identity input[readonly]{ background: rgba(0,0,0,.04); }

.row-2{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.actions-row{ display:flex; gap:10px; align-items:center; margin-top:6px; }
.save-hint{ font-weight:400; color:#666; }

.btn{
  --btnPadY: 10px; --btnPadX: 14px;
  padding: var(--btnPadY) var(--btnPadX);
  border-radius: 10px; border:1px solid var(--border);
  background: var(--surface); color: var(--text);
  cursor:pointer; text-decoration:none; display:inline-flex; align-items:center; justify-content:center;
  transition: filter .18s ease, transform .18s ease;
}
.btn:hover{ filter:brightness(1.03); }
.btn:active{ transform: translateY(1px); }
.btn.primary{ background: var(--blue); color:#fff; border-color: transparent; }
.btn.outline{ background: transparent; }
.btn.ghost{ background: transparent; border-color: var(--border); }
.btn.danger{ background: #d93025; border-color: #d93025; color:#fff; }

.sub-status{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
.sub-benefits{ margin:10px 0 0; padding-left:18px; font-weight:400; }
.sub-benefits li{ margin:4px 0; }

.security-list{ display:flex; flex-direction:column; gap:12px; }
.security-item{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
.security-text strong{ display:block; }
.muted{ color:#666; font-weight:400; }

.switch{ position:relative; display:inline-block; width:46px; height:26px; }
.switch input{ display:none; }
.slider{
  position:absolute; inset:0; background:#c6c6c6; border-radius:999px; transition:.2s;
}
.slider::after{
  content:""; position:absolute; top:3px; left:3px; width:20px; height:20px; border-radius:50%;
  background:#fff; transition:.2s;
}
.switch input:checked + .slider{ background:var(--blue); }
.switch input:checked + .slider::after{ transform: translateX(20px); }

.stat-cards{
  display:grid; grid-template-columns: repeat(3,1fr); gap:10px;
}
.stat{
  background: var(--panel-2); border:1px solid var(--border); border-radius:12px;
  padding:10px; text-align:center;
}
.stat-val{ font-size:1.4rem; font-weight:700; }
.stat-caption{ font-weight:400; color:#666; }

.card.danger{ border-color:#f3c1be; background:rgba(217,48,37,.04); }

/* адаптив */
@media (max-width: 980px){
  .profile-grid{ grid-template-columns:1fr; }
  .user-header{ grid-template-columns: 1fr; }
  .row-2{ grid-template-columns:1fr; }
  .sub-status{ flex-direction:column; align-items:flex-start; }
}

/* ===== settings page: равная высота и компактные карточки ===== */
/* Отменяем вертикальный интервал карточек ТОЛЬКО внутри сетки настроек */
.settings-grid .card + .card{ margin-top: 0; }

/* Сетка настроек и растягивание карточек по высоте строки */
.settings-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:16px;
  align-items:stretch;
}
.settings-grid > .card{
  display:flex;
  flex-direction:column;
  height:100%;
}
.settings-grid > .card .actions-row{ margin-top:auto; }

/* Компактные карточки */
.settings-grid > .card.slim{
  padding:12px;
  height:auto; /* контент определяет высоту, но в строке она выровняется */
}
.settings-grid > .card.slim .card-title{ margin-bottom:8px; }
.settings-grid > .card.slim .setting{ padding:6px 0; }

/* Общие элементы настроек */
.setting{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:8px 0; }
.setting + .setting{ border-top:1px solid var(--border); }
.setting-text{ display:flex; flex-direction:column; gap:4px; }
.row-between{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:8px 0; }
.row-inline{ display:flex; gap:10px; flex-wrap:wrap; }
.radio{ display:inline-flex; gap:6px; align-items:center; padding:6px 10px; border:1px solid var(--border); border-radius:10px; cursor:pointer; }
.radio input{ accent-color: var(--blue); }

@media (max-width: 980px){
  .settings-grid{ grid-template-columns:1fr; }
}

/* ===== auth: формы входа/регистрации (регистрация использует тот же блок) ===== */
.auth-wrap{ max-width: 520px; margin: 0 auto; }
.auth-card{ display:flex; flex-direction:column; gap:12px; }
.auth-card .field{ display:flex; flex-direction:column; gap:6px; }
.auth-card label{ font-weight:600; font-size:.95rem; }
.auth-card input[type="email"],
.auth-card input[type="password"],
.auth-card input[type="text"]{
  padding:10px 12px; border:1px solid var(--border); border-radius:10px;
  background: var(--bg); color: var(--text); font-weight:400;
}
.password-row{ display:flex; gap:8px; align-items:center; }
.pwd-toggle{
  width:40px; height:40px; min-width:40px; padding:0;
  display:flex; align-items:center; justify-content:center;
}
.pwd-toggle img{ width:18px; height:18px; display:block; }
.checkbox{ display:inline-flex; gap:8px; align-items:center; }
.checkbox input{ width:16px; height:16px; accent-color: var(--blue); }
.link{ color: var(--blue); text-decoration: none; }
.link:hover{ text-decoration: underline; }
.err{ min-height:1em; color:#c62828; font-weight:400; font-size:.9rem; }
.auth-bottom{ margin-top:6px; text-align:center; font-weight:400; }
.policy{ font-weight:400; color:#666; }
.hint{ font-weight:400; color:#666; font-size:.9rem; }


/* ===== TRAINING (страница тренировки) ===== */
.training-page .container{ max-width: 920px; }

.train-topbar{
  display:flex; align-items:center; justify-content:space-between;
  margin: 10px 0 12px;
}
.train-time .label{ font-weight:600; margin-right:8px; }
.icon-btn{ width:40px; height:40px; min-width:40px; padding:0; display:flex; align-items:center; justify-content:center; }

.train-stats{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-bottom: 14px;
}
.train-stats > div{
  background: var(--surface);
  border: 1px dashed var(--border);
  border-radius: 12px;
  padding: 10px 12px;
}

.train-question .q-media{
  margin-bottom: 10px; border-radius: 12px; overflow: hidden;
  border:1px solid var(--border); background: #0001; max-height: 280px;
}
.train-question .q-media img{ display:block; width:100%; height:auto; }

.q-text{ font-size: clamp(1.05rem, 1.6vw, 1.25rem); margin-bottom: 12px; }
.q-answers{
  display:flex; flex-direction:column; gap: 10px;
}
.answer{
  text-align:left; width:100%;
  background: var(--surface);
  color: var(--text);
  border:1px solid var(--border);
  border-radius: 12px;
  padding: 12px 14px;
  cursor:pointer;
  transition: filter .18s ease, transform .18s ease;
}
.answer:hover{ filter:brightness(1.03); }
.answer:active{ transform: translateY(1px); }

.train-bottom{
  display:flex; justify-content:flex-end; margin: 14px 0 0;
}

/* Настройки тренировки */
.settings-body{ display:flex; flex-direction:column; gap: 12px; }
.setting + .setting{ border-top:1px solid var(--border); }
.check{ display:flex; gap:8px; align-items:center; font-weight:400; }
.check input{ width:16px; height:16px; accent-color: var(--blue); }

.setting-themes{ position:relative; }
.themes-dropdown{
  margin-top: 10px;
  border:1px solid var(--border);
  background: var(--surface);
  border-radius: 12px;
  padding: 10px;
  max-height: 320px;
  overflow: auto;
  display: none;
}
.themes-dropdown.open{ display:block; }
.themes-grid{ display:grid; grid-template-columns: 1fr; gap:6px; }
.themes-dropdown .check span{ font-size:.95rem; }

/* Результаты */
.train-result-list{
  list-style:none; margin: 0 0 8px; padding:0;
}
.train-result-list li{ padding:8px 0; border-bottom:1px solid var(--border); }
.train-result-list li:last-child{ border-bottom:none; }

@media (max-width:700px){
  .train-stats{ grid-template-columns: 1fr; }
}

/* ===== EXAM ONE PAGE (intro + exam) ===== */
.exam-one-page .container{ max-width: 1120px; }

/* Intro */
.exam-intro{ padding:16px; }
.exam-title{
  text-align:center; text-transform:uppercase;
  font-size: clamp(20px, 2.2vw, 26px); letter-spacing:.02em;
  margin: 4px 0 10px;
}
.exam-meta{
  display:flex; gap:18px; justify-content:center; flex-wrap:wrap; margin-bottom: 12px;
}
.exam-intro-text p{ margin: 10px 0; font-weight:400; }
.exam-intro-text .center{ text-align:center; }
.exam-intro-text .small{ font-size:.9rem; }
.kbd{
  display:inline-block; padding:2px 6px; border:1px solid var(--border); border-radius:6px;
  background: var(--surface); font-weight:600; font-size:.9em;
}
.btn.tiny{
  padding: 4px 8px; border-radius:8px; font-size:.85rem;
  border:1px solid var(--border); background: var(--surface); color: var(--text);
}
.controls-table{ display:block; width:100%; margin: 12px 0; border:1px solid var(--border); border-radius:12px; overflow:hidden; }
.controls-table .row{ display:grid; grid-template-columns: 1.2fr 1fr 1fr; border-top:1px solid var(--border); }
.controls-table .row.head{ background: rgba(0,0,0,.04); border-top:0; }
.controls-table .cell{ padding: 10px 12px; }
.controls-table .center{ text-align:center; }
.exam-intro-actions{ margin-top: 14px; display:flex; gap:10px; justify-content:center; }

/* Exam: info line + progress */
.exam-info-line{
  display:flex; align-items:center; flex-wrap:wrap; gap:10px;
  font-weight:700; margin: 8px 0 10px;
}
.exam-info-line .dot{
  width:6px; height:6px; border-radius:50%; background:#9aa4b2; display:inline-block;
}

.exam-progress{
  display:flex; flex-wrap:wrap; gap:6px;
  margin-bottom: 12px;
}
.progress-item{
  width:24px; height:24px; border-radius:6px;
  border:1px solid var(--border); background:#fff;
  display:inline-flex; align-items:center; justify-content:center;
  font-size:.85rem; font-weight:700; user-select:none; cursor:pointer;
  transition: transform .12s ease, filter .12s ease, border-color .12s ease;
}
.progress-item:hover{ filter:brightness(1.03); transform: translateY(-1px); }
.progress-item.current{ border-color:#4c9bff; box-shadow:0 0 0 2px rgba(76,155,255,.18) inset; }
.progress-item.ok{ background:#e6f4ea; border-color:#c8e6c9; }
.progress-item.fail{ background:#ffebee; border-color:#ffcdd2; }

/* Exam UI */
.exam-grid{
  display:grid; grid-template-columns: repeat(4, 1fr); gap: 14px;
}
.exam-card{
  border:2px solid var(--border); border-radius:14px; background:var(--surface);
  overflow:hidden; cursor:pointer; transition:.18s transform ease, .18s filter ease;
  display:flex; flex-direction:column;
}
.exam-card:hover{ filter:brightness(1.03); transform: translateY(-1px); }
.exam-card .thumb{ aspect-ratio: 16/9; background: #0001; display:flex; align-items:center; justify-content:center; }
.exam-card .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
.exam-card .title{ padding:10px 12px; font-weight:700; }
.exam-card .num{
  position:absolute; top:8px; left:8px; background:#fff; border:1px solid var(--border);
  border-radius:8px; padding:2px 6px; font-weight:700;
}
.exam-card-wrap{ position:relative; }
.exam-card.ok{ border-color:#2e7d32; }
.exam-card.fail{ border-color:#f9a825; }

.exam-view{ margin-top: 14px; }
.exam-view-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.badges .badge{
  display:inline-flex; align-items:center; justify-content:center;
  width:32px; height:32px; border-radius:10px; border:1px solid var(--border); background:var(--surface);
  font-weight:700;
}
.exam-view .q-media{ margin: 8px 0 12px; border-radius: 12px; overflow:hidden; border:1px solid var(--border); }
.exam-view .q-media img{ width:100%; height:auto; display:block; }
.exam-view .q-text{ font-size: clamp(1.05rem, 1.6vw, 1.25rem); margin-bottom: 12px; }

.exam-view .q-answers{ display:flex; flex-direction:column; gap:10px; }
.exam-view .answer{
  text-align:left; width:100%;
  background: var(--surface); color: var(--text);
  border:1px solid var(--border); border-radius:12px; padding:12px 14px; cursor:pointer;
  transition: filter .18s ease, transform .18s ease;
}
.exam-view .answer:hover{ filter:brightness(1.03); }
.exam-view .answer:active{ transform: translateY(1px); }

.exam-view-actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:12px; }

/* Результаты */
.exam-result-brief .res-line{ padding:6px 0; }
.exam-detailed{ margin-top: 12px; }
.detail-list{ display:flex; flex-direction:column; gap:12px; max-height:60vh; overflow:auto; }
.detail-item{
  border:1px solid var(--border); border-radius:12px; padding:10px 12px; background: var(--surface);
}
.detail-item .head{ display:flex; align-items:center; gap:10px; margin-bottom:6px; }
.detail-item .pill{ padding:2px 8px; border-radius:999px; font-weight:700; font-size:.9rem; }
.pill.ok{ background:#e6f4ea; color:#1b5e20; }
.pill.fail{ background:#fff3e0; color:#e65100; }
.detail-item .answers{ display:flex; flex-direction:column; gap:6px; }
.detail-item .ans{ padding:6px 8px; border:1px solid var(--border); border-radius:10px; }
.detail-item .ans.correct{ background:#e6f4ea; border-color:#c8e6c9; }
.detail-item .ans.user-wrong{ background:#ffebee; border-color:#ffcdd2; }

@media (max-width: 980px){
  .exam-grid{ grid-template-columns: 1fr 1fr; }
}
@media (max-width: 640px){
  .exam-grid{ grid-template-columns: 1fr; }
}

/* ===== Exam: phase pill (доп.блок) ===== */
.phase-pill{
  display:inline-flex; align-items:center; gap:8px;
  padding:4px 10px; border-radius:999px; border:1px solid var(--border);
  background: var(--surface); font-weight:700; font-size:.9rem;
}
.phase-pill .small{ font-weight:600; font-size:.9rem; color:#666; }


/* ===== Exam: визуальные улучшения ===== */

/* Инфо-строка липнет под шапкой */
.exam-info-line{
  position: sticky;
  top: calc(var(--header-h) + 6px);
  z-index: 5;
  padding: 6px 10px;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--surface);
  box-shadow: 0 4px 14px rgba(0,0,0,.05);
}

/* Квадраты прогресса — плавные состояния */
.exam-progress{ gap:8px; }
.progress-item{
  width:26px; height:26px; border-radius:8px;
  transition: transform .14s ease, filter .14s ease, border-color .18s ease, background-color .18s ease;
}
.progress-item:focus-visible{
  outline: 2px solid #7fb3ff;
  outline-offset: 2px;
}
.progress-item.current{ box-shadow: 0 0 0 3px rgba(76,155,255,.16) inset; }
.progress-item.ok{ background:#e8f6ee; border-color:#c8e6c9; }
.progress-item.fail{ background:#ffeded; border-color:#ffcdd2; }

/* Вариант с номерами в квадратиках — включается классом .progress--num на контейнере */
.exam-progress.progress--num .progress-item{
  font-size: .8rem; color:#3a3a3a;
}

/* Шапка вопроса + «пилюля» фазы — немного визуала */
.phase-pill{
  display:inline-flex; align-items:center; gap:8px;
  margin: 2px 0 6px;
  padding:4px 10px; border-radius:999px;
  border:1px solid var(--border);
  background: var(--surface);
  font-weight:700; font-size:.92rem;
}
.phase-pill .small{ font-weight:600; font-size:.9rem; color:#666; }

/* Ответы: мягкий hover/active и короткий фидбек цвета */
.exam-view .answer{
  position: relative;
  overflow: hidden;
}
.exam-view .answer:hover{ filter:brightness(1.03); transform: translateY(0); }
.exam-view .answer:active{ transform: translateY(1px); }

.answer.flash-correct{
  border-color:#16a34a !important;
  background: #e8f6ee !important;
  animation: answerPulseOk .28s ease;
}
.answer.flash-wrong{
  border-color:#e11d48 !important;
  background:#ffeded !important;
  animation: answerPulseNo .28s ease;
}

@keyframes answerPulseOk{
  0%{ box-shadow: 0 0 0 0 rgba(22,163,74,.25); }
  100%{ box-shadow: 0 0 0 10px rgba(22,163,74,0); }
}
@keyframes answerPulseNo{
  0%{ box-shadow: 0 0 0 0 rgba(225,29,72,.25); }
  100%{ box-shadow: 0 0 0 10px rgba(225,29,72,0); }
}

/* Картинка вопроса — единый стиль */
.exam-view .q-media{
  border-radius:14px; overflow:hidden;
  border:1px solid var(--border);
  background: #00000008;
}

/* Модалка результатов — чутка плотнее */
.modal .exam-result-brief .res-line{ padding:4px 0; }


/* ===== Exam: мини-иконки, липкая инфо-строка, мобильная адаптация ===== */

/* Базовый контейнер инфо-строки */
.exam-info-line{
  position: relative;     /* больше не липнет */
  top: auto;
  z-index: 1;
  padding: 6px 10px;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--surface);
  box-shadow: 0 4px 14px rgba(0,0,0,.05);
  display: flex; flex-wrap: wrap; gap: 8px;
  margin-bottom: 12px;    /* чтобы не липло к прогрессу */
}


/* Чипы внутри инфо-строки */
.exam-info-line .chip{
  display:inline-flex; align-items:center; gap:8px;
  padding: 4px 8px;
  border-radius: 999px;
  background: transparent;
  font-weight:700;
  white-space: nowrap;
}
.exam-info-line .chip.time{
  background: rgba(76,155,255,.08);
  border: 1px solid rgba(76,155,255,.25);
  border-radius: 10px;
}

/* Универсальный инлайн-икон-компонент */
.ico{
  width: 1em; height: 1em; display:inline-block;
  background-repeat: no-repeat; background-position:center; background-size: 100% 100%;
  filter: grayscale(0);
  opacity: .9;
}

/* Белые «точки» больше не нужны, но оставим совместимость */
.exam-info-line .dot{ display:none; }

/* Иконки через data-uri SVG (окрашиваются текущим цветом текста) */
:root{ --ico-fill: %230b3a6a; } /* по умолчанию близко к var(--blue). В тёмной теме будет читаться */
:root[data-theme="dark"]{ --ico-fill: %23eaf2ff; }

.ico-term{ background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23aaa' viewBox='0 0 24 24'><path d='M3 5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3v-2h16V5H5v6H3z'/><path d='M7 21H3a1 1 0 1 1 0-2h4a1 1 0 1 1 0 2z'/></svg>"); }
.ico-user{ background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23aaa' viewBox='0 0 24 24'><path d='M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-5.33 0-8 2.67-8 6v1h16v-1c0-3.33-2.67-6-8-6z'/></svg>"); }
.ico-dob { background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23aaa' viewBox='0 0 24 24'><path d='M7 2h2v2h6V2h2v2h3a1 1 0 0 1 1 1v3H3V5a1 1 0 0 1 1-1h3zM3 10h18v9a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1z'/></svg>"); }
.ico-cat { background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23aaa' viewBox='0 0 24 24'><path d='M12 2l9 4v6c0 5-3.5 9.74-9 10-5.5-.26-9-5-9-10V6zM7 12l5 6 5-6-5-6z'/></svg>"); }
.ico-time{ background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23aaa' viewBox='0 0 24 24'><path d='M12 8a1 1 0 0 1 1 1v3.59l2.3 2.3a1 1 0 1 1-1.42 1.42l-2.59-2.59A1 1 0 0 1 11 13V9a1 1 0 0 1 1-1z'/><path d='M12 22a10 10 0 1 1 10-10 10.011 10.011 0 0 1-10 10z'/></svg>"); }

/* Пилюля фазы — уже была, чуть подправим расстояния и иконки внутри */
.phase-pill{ display:inline-flex; align-items:center; gap:8px; margin: 2px 0 8px; padding:4px 10px; border-radius:999px; border:1px solid var(--border); background: var(--surface); font-weight:700; font-size:.92rem; }
.phase-pill .small{ font-weight:600; font-size:.9rem; color:#666; }
.phase-pill .ico{ opacity:.8; }

/* Прогресс — вместо flex используем grid: на десктопе 20 столбцов, на мобиле 10+10 */
.exam-progress{
  display:grid;
  grid-template-columns: repeat(20, minmax(0, 1fr));
  gap:8px;
  margin-bottom: 12px;
}
.progress-item{
  width:100%; aspect-ratio: 1/1; /* ровные квадраты в сетке */
  border-radius:8px;
  border:1px solid var(--border); background:#fff;
  display:inline-flex; align-items:center; justify-content:center;
  font-size:.85rem; font-weight:700; user-select:none; cursor:pointer;
  transition: transform .14s ease, filter .14s ease, border-color .18s ease, background-color .18s ease;
}
.progress-item:hover{ filter:brightness(1.03); transform: translateY(-1px); }
.progress-item:focus-visible{ outline: 2px solid #7fb3ff; outline-offset: 2px; }
.progress-item.current{ border-color:#4c9bff; box-shadow: 0 0 0 3px rgba(76,155,255,.16) inset; }
.progress-item.ok{ background:#e8f6ee; border-color:#c8e6c9; }
.progress-item.fail{ background:#ffeded; border-color:#ffcdd2; }

/* Ответы — уже с фидбек-анимацией; для тач чуть крупнее отступы */
.exam-view .answer{ padding:14px 16px; }

/* Мобильная адаптация */
@media (max-width: 740px){
  .exam-info-line{
    top: calc(var(--header-h) + 4px);
    padding: 6px 8px;
    gap: 6px;
  }
  .exam-info-line .chip{ padding: 3px 6px; font-size: .95rem; }
  .exam-info-line .chip strong{ font-weight: 800; }

  .exam-progress{
    grid-template-columns: repeat(10, minmax(0, 1fr)); /* две строки по 10 */
    gap: 6px;
  }
  .progress-item{ border-radius: 6px; }

  .exam-view .q-text{ font-size: clamp(1rem, 4.5vw, 1.15rem); }
  .exam-view .answer{ padding: 14px; font-size: 1rem; }
}

/* Совсем узкие экраны */
@media (max-width: 420px){
  .exam-info-line{ gap: 4px; }
  .exam-info-line .chip{ padding: 2px 6px; font-size: .9rem; }
  .exam-info-line .chip.time{ border-width: 1px; }
}

/* === LEARNING (Обучение) — заскоуплено под .page-learning === */
.page-learning { --learn-gap: 16px; --learn-accent: var(--blue); }

/* Шапка секции + прогресс */
.page-learning .learn-hero{
  display:flex;justify-content:space-between;align-items:flex-end;gap:20px;
  margin:28px 0 18px;
}
.page-learning .learn-hero h1{font-size:clamp(24px, 2.2vw, 34px);line-height:1.1;}
.page-learning .learn-hero .lead{opacity:.8;font-weight:400;margin-top:6px}
.page-learning .learn-progress{flex:1;max-width:420px}
.page-learning .learn-progress .label{
  display:flex;justify-content:space-between;font-size:14px;margin:0 0 8px;opacity:.9
}
.page-learning .meter{
  position:relative;height:12px;background:var(--surface);border-radius:999px;overflow:hidden;
  box-shadow:inset 0 0 0 1px var(--border)
}
.page-learning .meter .bar{
  width:0%;height:100%;
  background:linear-gradient(90deg,var(--learn-accent),color-mix(in oklab, var(--learn-accent), white 35%));
  border-radius:inherit;transition:width .45s ease
}

/* Сетка карточек: единая высота */
.page-learning .learn-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:var(--learn-gap);
  align-items:stretch; /* выравнивает карточки по высоте */
}

/* Карточка урока */
.page-learning .learn-card{
  position:relative;display:flex;flex-direction:column;justify-content:space-between;
  padding:18px 16px;border-radius:20px;
  background:var(--surface);color:var(--text);
  text-decoration:none;box-shadow:0 1px 0 var(--border);border:1px solid var(--border);
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease, background-color .2s ease;
  min-height:160px; /* общий визуальный размер */
  height:100%;      /* растягивается в ячейке */
}

/* Улучшенный контраст в светлой теме */
:root:not([data-theme="dark"]) .page-learning .learn-card{
  background:#f0f4ff;     /* чуть насыщеннее, чем var(--surface) */
  color:#0a1a3d;          /* более контрастный текст */
}

/* Тёмная тема — по умолчанию из переменных */
:root[data-theme="dark"] .page-learning .learn-card{
  background:var(--surface);color:var(--text);
}

.page-learning .learn-card:hover{
  transform:translateY(-3px);
  box-shadow:0 6px 24px rgba(0,0,0,.12);
  border-color:color-mix(in oklab, var(--learn-accent), white 40%);
  background-color:color-mix(in oklab, var(--surface), white 10%);
}
.page-learning .learn-card:focus-visible{
  outline:2px solid color-mix(in oklab, var(--learn-accent), white 20%);outline-offset:2px
}

/* Содержимое карточки */
.page-learning .learn-card .num{
  display:inline-grid;place-items:center;width:34px;height:34px;border-radius:10px;
  background:color-mix(in oklab, var(--learn-accent), white 75%);
  font-variant-numeric:tabular-nums;margin-bottom:10px;flex:0 0 auto;
}
.page-learning .learn-card .title{
  flex:1 1 auto;           /* занимает доступную высоту для равных карточек */
  font-weight:700;line-height:1.25;color:inherit;
  word-wrap:break-word;overflow-wrap:break-word;
}
.page-learning .learn-card .meta{
  display:flex;align-items:center;gap:8px;margin-top:10px;font-size:13px;opacity:.9;flex:0 0 auto;
}
.page-learning .learn-card .check{
  width:18px;height:18px;border-radius:50%;border:2px solid var(--border);
  display:inline-block;flex:0 0 auto;transform:scale(.95);transition:all .2s ease
}
.page-learning .learn-card.is-done .check{
  background:linear-gradient(180deg, var(--learn-accent), color-mix(in oklab, var(--learn-accent), black 15%));
  border-color:transparent;box-shadow:inset 0 0 0 2px rgba(255,255,255,.85);
}

/* Плавное появление карточек */
@media (prefers-reduced-motion:no-preference){
  .page-learning .learn-card{animation:learn-fadeup .5s both;}
  .page-learning .learn-card:nth-child(2){animation-delay:.02s}
  .page-learning .learn-card:nth-child(3){animation-delay:.04s}
  .page-learning .learn-card:nth-child(4){animation-delay:.06s}
  .page-learning .learn-card:nth-child(5){animation-delay:.08s}
  .page-learning .learn-card:nth-child(6){animation-delay:.10s}
  .page-learning .learn-card:nth-child(7){animation-delay:.12s}
  .page-learning .learn-card:nth-child(8){animation-delay:.14s}
  .page-learning .learn-card:nth-child(9){animation-delay:.16s}
  .page-learning .learn-card:nth-child(10){animation-delay:.18s}
  .page-learning .learn-card:nth-child(11){animation-delay:.20s}
  .page-learning .learn-card:nth-child(12){animation-delay:.22s}
  .page-learning .learn-card:nth-child(13){animation-delay:.24s}
  .page-learning .learn-card:nth-child(14){animation-delay:.26s}
}
@keyframes learn-fadeup{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}


/* LESSON PAGE */
.page-lesson{padding:28px 0 36px;}
.page-lesson .crumbs{font-size:14px;margin-bottom:14px;opacity:.9}
.page-lesson .crumbs a{color:inherit;opacity:.9}
.page-lesson .lesson-header{display:flex;justify-content:space-between;align-items:flex-end;gap:16px;margin-bottom:20px}
.page-lesson .lesson-header h1{font-size:clamp(22px, 2.1vw, 32px);line-height:1.15}
.page-lesson .lesson-nav{display:flex;gap:8px;flex-wrap:wrap}
.page-lesson .pill{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);border-radius:999px;padding:8px 12px;background:var(--surface);text-decoration:none;color:inherit;font-size:14px;transition:transform .18s ease, box-shadow .18s ease}
.page-lesson .pill:hover{transform:translateY(-2px);box-shadow:0 4px 14px rgba(0,0,0,.12)}

.page-lesson .lesson-body{display:grid;grid-template-columns:1fr;gap:16px}
.page-lesson .card{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:18px;box-shadow:0 1px 0 var(--border)}
.page-lesson .card h2{font-size:18px;margin-bottom:8px}
.page-lesson .placeholder{min-height:140px;display:grid;place-items:center;opacity:.8;font-weight:400}
.page-lesson .test-box{min-height:160px;display:grid;place-items:center;border:2px dashed var(--border);border-radius:16px;background:color-mix(in oklab, var(--surface), white 8%)}
/* === Fix: lesson header shouldn't inherit site <header> styles === */
.page-lesson .lesson-header{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  border-radius: 0 !important;
  padding: 0 !important;
  min-height: unset !important;
}

/* аккуратная подчеркивающая линия под заголовком */
.page-lesson .lesson-header{ margin-bottom: 20px; }
.page-lesson .lesson-header::after{
  content: "";
  display: block;
  height: 1px;
  background: var(--border);
  margin-top: 14px;
}

/* === Навигация по урокам (верх/низ) === */
.page-lesson .lesson-nav{
  display:flex;
  gap:8px;
  justify-content:flex-end; /* прижимаем к правому краю */
  flex-wrap:wrap;
}

.page-lesson .lesson-nav.bottom-nav{
  margin-top:16px;
  justify-content:flex-end;
}

/* Кнопки-пилюли */
.page-lesson .pill{
  display:inline-flex;
  align-items:center;
  gap:8px;
  border:1px solid var(--border);
  border-radius:999px;
  padding:8px 14px;
  background:var(--surface);
  text-decoration:none;
  color:inherit;
  font-size:14px;
  transition:transform .18s ease, box-shadow .18s ease, background-color .18s ease;
}
.page-lesson .pill:hover{
  transform:translateY(-2px);
  box-shadow:0 4px 14px rgba(0,0,0,.12);
  background:color-mix(in oklab, var(--surface), white 8%);
}

/* === ВЫРАВНИВАНИЕ ВЕРХНЕЙ НАВИГАЦИИ УРОКА === */
.page-lesson .lesson-header {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  gap: 12px;
  background: transparent !important;
  padding: 0 !important;
  border: none !important;
  box-shadow: none !important;
  border-radius: 0 !important;
}

/* Заголовок и навигация располагаются в одной линии */
.page-lesson .lesson-header h1 {
  margin: 0;
}

/* Контейнер навигации в верхней части */
.page-lesson .lesson-header .lesson-nav {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  flex-wrap: wrap;
  margin-top: 6px;  /* немного воздуха под заголовком */
}

/* чтобы линия под заголовком не отрезала кнопки */
.page-lesson .lesson-header::after {
  content: "";
  display: block;
  height: 1px;
  background: var(--border);
  margin-top: 14px;
}

/* Кнопки совпадают с нижними */
.page-lesson .lesson-header .pill {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 8px 14px;
  background: var(--surface);
  text-decoration: none;
  color: inherit;
  font-size: 14px;
  transition: transform .18s ease, box-shadow .18s ease, background-color .18s ease;
}
.page-lesson .lesson-header .pill:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 14px rgba(0,0,0,.12);
  background: color-mix(in oklab, var(--surface), white 8%);
}

/* === QUIZ (тесты) — только на страницах уроков === */
.page-lesson .quiz { display:grid; gap:14px; }

.page-lesson .quiz-card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:16px;
  padding:14px;
  box-shadow:0 1px 0 var(--border);
}

.page-lesson .quiz-title{ font-size:16px; opacity:.9; }

.page-lesson .quiz-q{
  display:grid; gap:10px;
  border:1px dashed var(--border);
  border-radius:12px;
  padding:12px;
}
.page-lesson .quiz-q h3{ font-size:16px; line-height:1.35; margin:0; }

.page-lesson .quiz-answers{ display:grid; gap:8px; }

.page-lesson .quiz-answer{
  display:flex; align-items:flex-start; gap:10px;
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px 12px;
  background:color-mix(in oklab, var(--surface), white 6%);
  cursor:pointer; user-select:none;
  transition:transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease;
}
.page-lesson .quiz-answer:hover{
  transform:translateY(-1px);
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}
.page-lesson .quiz-answer input{ margin-top:2px; }

.page-lesson .quiz-controls{
  display:flex; justify-content:flex-end; gap:8px; flex-wrap:wrap; margin-top:8px;
}

.page-lesson .quiz-btn{
  display:inline-flex; align-items:center; gap:8px;
  border:1px solid var(--border); border-radius:999px;
  padding:8px 14px; background:var(--surface);
  text-decoration:none; color:inherit; font-size:14px;
  cursor:pointer;
  transition:transform .18s ease, box-shadow .18s ease, background-color .18s ease;
}
.page-lesson .quiz-btn:hover{
  transform:translateY(-2px);
  box-shadow:0 4px 14px rgba(0,0,0,.12);
  background:color-mix(in oklab, var(--surface), white 8%);
}

.page-lesson .quiz-result{
  border-radius:12px;
  padding:10px 12px;
  background:color-mix(in oklab, var(--surface), white 10%);
  border:1px solid var(--border);
}

.page-lesson .quiz-answer.is-correct      { border-color: #43a047; }
.page-lesson .quiz-answer.is-wrong        { border-color: #d84315; }
.page-lesson .quiz-answer.is-correct::after{
  content:"✓"; margin-left:auto; font-weight:700;
}
.page-lesson .quiz-answer.is-wrong::after {
  content:"✕"; margin-left:auto; font-weight:700;
}

/* ============================
   BUILDER — страница конструктора
   (всё заскоуплено под .page-builder)
============================ */
.page-builder .card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  box-shadow:0 1px 0 var(--border);
}

.page-builder .form-grid{ display:grid; gap:12px; }
.page-builder .form-row{ display:grid; gap:6px; }

.page-builder input[type="text"],
.page-builder input[type="number"]{
  width:100%;
  padding:10px 12px;
  border:1px solid var(--border);
  border-radius:12px;
  background:var(--bg);
  color:var(--text);
}

.page-builder .input{ /* для readonly ссылки */
  width:100%;
  padding:10px 12px;
  border:1px solid var(--border);
  border-radius:12px;
  background:var(--bg);
  color:var(--text);
}

.page-builder .row-between{
  display:flex; justify-content:space-between; align-items:center;
}

.page-builder .flex{ display:flex; align-items:center; }

/* Кнопки (используем общий стиль, слегка усилим hover) */
.page-builder .btn{
  display:inline-flex; align-items:center; gap:8px;
  border:1px solid var(--border);
  border-radius:999px;
  padding:10px 14px;
  background:var(--surface);
  color:inherit;
  text-decoration:none;
  cursor:pointer;
  transition:transform .18s ease, box-shadow .18s ease, background-color .18s ease;
}
.page-builder .btn:hover{
  transform:translateY(-1px);
  box-shadow:0 4px 14px rgba(0,0,0,.12);
  background:color-mix(in oklab, var(--surface), white 8%);
}
.page-builder .btn.primary{
  background:var(--blue);
  color:#fff;
  border-color:transparent;
}
.page-builder .btn.primary:hover{
  background:color-mix(in oklab, var(--blue), black 10%);
}
.page-builder .btn.outline{
  background:transparent;
}

/* Список экзаменов */
.page-builder .exam-list{ display:grid; gap:12px; }
.page-builder .exam-item{
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  border:1px solid var(--border);
  border-radius:12px; padding:12px;
  background:var(--surface);
}
.page-builder .exam-title{
  font-weight:700; color:inherit; text-decoration:none;
}
.page-builder .exam-title:hover{ text-decoration:underline; }
.page-builder .exam-actions{ display:flex; gap:8px; flex-wrap:wrap; }
.page-builder .muted{ opacity:.8; }

/* Таблица статистики */
.page-builder .table-wrap{
  border:1px solid var(--border);
  border-radius:12px;
  overflow:hidden;
}
.page-builder .table{ width:100%; border-collapse:collapse; }
.page-builder .table th, .page-builder .table td{
  padding:10px 12px; border-bottom:1px solid var(--border); text-align:left;
}
.page-builder .table thead th{ font-weight:700; background:color-mix(in oklab, var(--surface), white 8%); }

/* Выпадающий список тем — берём стиль как в training.html.
   Если у тебя уже есть общие стили для .themes-dropdown/.check/.themes-grid,
   эти правила не обязательны. Оставляю мягкие дефолты на всякий случай. */
.page-builder .themes-dropdown{
  margin-top:8px; display:none;
  border:1px solid var(--border); border-radius:12px; padding:10px;
  background:var(--surface);
}
.page-builder .themes-dropdown.open{ display:block; }
.page-builder .themes-grid{ display:grid; gap:8px; grid-template-columns:repeat(auto-fit, minmax(240px, 1fr)); }
.page-builder .check{ display:flex; align-items:center; gap:8px; cursor:pointer; }
.page-builder .check input{ transform:translateY(1px); }




/* === Training page button animations (hover + press) === */
.page.training-page .train-bottom .btn,
#trainResultModal .btn {
  transition: transform 0.2s ease, box-shadow 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;
  will-change: transform, box-shadow;
}

/* "Завершить" (danger) */
.page.training-page .btn.danger{ position:relative; overflow:hidden; }
.page.training-page .btn.danger::after{
  content:""; position:absolute; inset:0;
  background: radial-gradient(circle at center, rgba(239,68,68,0.15) 0%, transparent 70%);
  opacity:0; transition: opacity 0.3s ease;
}
.page.training-page .btn.danger:hover::after{ opacity:1; }
.page.training-page .btn.danger:hover{
  transform: scale(1.03);
  box-shadow: 0 6px 16px rgba(239,68,68,0.35);
}

/* "На главную" (outline) */
#trainResultModal .btn.outline{ transition: all 0.25s ease; }
#trainResultModal .btn.outline:hover{
  transform: translateY(-2px);
  border-color: color-mix(in oklab, var(--blue, #2563eb), black 15%);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

/* "Ещё раз" (primary) */
#trainResultModal .btn.primary{ transition: all 0.25s ease; }
#trainResultModal .btn.primary:hover{
  transform: scale(1.05);
  box-shadow: 0 0 18px color-mix(in oklab, var(--blue, #2563eb), white 50%);
}

/* Press (click) effect */
.page.training-page .btn.is-pressing,
#trainResultModal .btn.is-pressing{
  transform: scale(0.97) !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12) !important;
}


/* === Light theme visibility fixes (exam nav + lesson titles + top pills) === */
:is(:root,html,body)[data-theme="light"]{
  --text-strong: #0f172a;   /* заголовки/основной */
  --text-base:   #111827;   /* тело */
  --text-muted:  #334155;   /* подписи */
  --surface-weak:#f8fafc;   /* фон для светлых кнопок/pills */
  --border-weak: #cbd5e1;   /* светлая рамка */
}

/* 1) Навигация экзамена / список вопросов — сделать текст читаемым */
:is(:root,html,body)[data-theme="light"] .exam-grid,
:is(:root,html,body)[data-theme="light"] .exam-grid *{
  color: var(--text-strong);
}
:is(:root,html,body)[data-theme="light"] .exam-grid .cell,
:is(:root,html,body)[data-theme="light"] [data-q],
:is(:root,html,body)[data-theme="light"] .q-nav-item{
  color: var(--text-strong);
  border-color: var(--border-weak);
  background: #fff;
}
/* Текст текущего вопроса и ответы */
:is(:root,html,body)[data-theme="light"] .q-text,
:is(:root,html,body)[data-theme="light"] .train-question h2{
  color: var(--text-base);
}
:is(:root,html,body)[data-theme="light"] .q-answers label,
:is(:root,html,body)[data-theme="light"] .q-answers .answer{
  color: var(--text-base);
}

/* 2) Названия уроков — на странице списка и внутри урока */
:is(:root,html,body)[data-theme="light"] .page-learning .lesson-card h3,
:is(:root,html,body)[data-theme="light"] .page-lesson h1,
:is(:root,html,body)[data-theme="light"] .page-lesson .lesson-title{
  color: var(--text-strong);
}
:is(:root,html,body)[data-theme="light"] .page-learning .lesson-card .muted,
:is(:root,html,body)[data-theme="light"] .page-lesson .muted{
  color: var(--text-muted);
}

/* 3) Верхние кнопки "К списку" / "Урок →" в уроках */
:is(:root,html,body)[data-theme="light"] .page-lesson .lesson-nav a,
:is(:root,html,body)[data-theme="light"] .page-lesson .lesson-nav .pill,
:is(:root,html,body)[data-theme="light"] .page-lesson .lesson-nav .btn{
  color: var(--text-strong);
  background: var(--surface-weak);
  border-color: var(--border-weak);
}
:is(:root,html,body)[data-theme="light"] .page-lesson .lesson-nav a:hover,
:is(:root,html,body)[data-theme="light"] .page-lesson .lesson-nav .pill:hover,
:is(:root,html,body)[data-theme="light"] .page-lesson .lesson-nav .btn:hover{
  background: color-mix(in oklab, var(--surface-weak), white 12%);
  box-shadow: 0 4px 14px rgba(0,0,0,.08);
}

/* на всякий случай: общий muted в светлой теме */
:is(:root,html,body)[data-theme="light"] .muted{ color: var(--text-muted); }


/* === Exam page buttons animations (hover + press) === */
.page.exam-page .btn {
  transition: transform 0.2s ease, box-shadow 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;
  will-change: transform, box-shadow;
}

/* Primary */
.page.exam-page .btn.primary:hover {
  transform: scale(1.05);
  box-shadow: 0 0 16px color-mix(in oklab, var(--blue, #2563eb), white 50%);
}

/* Outline */
.page.exam-page .btn.outline:hover {
  transform: translateY(-2px);
  border-color: color-mix(in oklab, var(--blue, #2563eb), black 15%);
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

/* Danger (красные, завершить экзамен) */
.page.exam-page .btn.danger {
  position: relative;
  overflow: hidden;
}
.page.exam-page .btn.danger::after {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, rgba(239,68,68,0.15) 0%, transparent 70%);
  opacity: 0;
  transition: opacity 0.3s ease;
}
.page.exam-page .btn.danger:hover::after {
  opacity: 1;
}
.page.exam-page .btn.danger:hover {
  transform: scale(1.03);
  box-shadow: 0 6px 16px rgba(239,68,68,0.35);
}

/* Нажатие */
.page.exam-page .btn.is-pressing {
  transform: scale(0.97) !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15) !important;
}



/* === Exam buttons animations (selector fixed for .exam-one-page) === */
.exam-one-page .btn {
  transition: transform 0.2s ease, box-shadow 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;
  will-change: transform, box-shadow;
}
.exam-one-page .btn.primary:hover {
  transform: scale(1.05);
  box-shadow: 0 0 16px color-mix(in oklab, var(--blue, #2563eb), white 50%);
}
.exam-one-page .btn.outline:hover {
  transform: translateY(-2px);
  border-color: color-mix(in oklab, var(--blue, #2563eb), black 15%);
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}
.exam-one-page .btn.danger { position: relative; overflow: hidden; }
.exam-one-page .btn.danger::after {
  content: ""; position: absolute; inset: 0;
  background: radial-gradient(circle at center, rgba(239,68,68,0.15) 0%, transparent 70%);
  opacity: 0; transition: opacity 0.3s ease;
}
.exam-one-page .btn.danger:hover::after { opacity: 1; }
.exam-one-page .btn.danger:hover { transform: scale(1.03); box-shadow: 0 6px 16px rgba(239,68,68,0.35); }
.exam-one-page .btn.is-pressing {
  transform: scale(0.97) !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15) !important;
}



/* === GLOBAL PRESS EFFECT — unified click animation for all buttons === */
:where(.btn, button, [role="button"], .pill, .icon-btn, .pay-btn){
  transition: transform 0.18s ease, box-shadow 0.2s ease, background-color 0.2s ease, border-color 0.2s ease;
  will-change: transform, box-shadow;
}
:where(.btn, button, [role="button"], .pill, .icon-btn, .pay-btn).is-pressing{
  transform: scale(0.97) !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12) !important;
}
@media (prefers-reduced-motion: reduce){
  :where(.btn, button, [role="button"], .pill, .icon-btn, .pay-btn){
    transition: none;
  }
}
